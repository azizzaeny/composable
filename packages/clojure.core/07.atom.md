### @zaeny/clojure.core/atom

#### atom
```js path=dist/core.js
function atom(val) {
  let value = val;
  let watchers = new Set();
  let validator = undefined;

  function deref() {
    return value;
  }

  function reset(newVal) {
    if (validator !== undefined) {
      validator(newVal);
    }
    const oldVal = value;
    value = newVal;
    watchers.forEach((watcher) => watcher(newVal, oldVal));
    return newVal;
  }

  function swap(fn, ...args) {
    return reset(fn(value, ...args));
  }

  function compareAndSet(expectedVal, newVal) {
    if (deref() === expectedVal) {
      reset(newVal);
      return true;
    } else {
      return false;
    }
  }

  function addWatch(watcherFn) {
    watchers.add(watcherFn);
  }

  function removeWatch(watcherFn) {
    watchers.delete(watcherFn);
  }

  function setValidator(validatorFn) {
    validator = validatorFn;
  }

  function getValidator() {
    return validator;
  }

  return {
    deref,
    reset,
    swap,
    compareAndSet,
    addWatch,
    removeWatch,
    setValidator,
    getValidator,
  };
}

```
usage: 
```js path=dist/test.core.js

```

#### deref

#### reset

#### swap
#### compareAndSet
#### removeWatch
#### setValidator
#### getValidator
